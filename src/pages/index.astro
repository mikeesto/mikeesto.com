---
import { Image } from "astro:assets";
import Base from "../layouts/Base.astro";
import FeaturedPosts from "../components/FeaturedPosts.astro";
import FeaturedProjects from "../components/FeaturedProjects.astro";
import Contact from "../components/Contact.astro";
import michaelImg from "/public/me-2025.jpg";
---

<Base title="Michael Esteban">
  <main>
    <h2 class="text-xl inline-block mb-2 border-b-[3px] border-b-[gold]">
      Hi!
    </h2>

    <div class="flex flex-col md:flex-row items-center gap-8 mb-6">
      <p class="text-lg md:w-2/3">
        I'm Michael Esteban, a software engineer from Brisbane, Australia (where
        it is <span data-timestamp-text="currently {time}">loading time...</span
        >). I'm passionate about open source and education. I enjoy building
        small tools, exploring AI, and tinkering with an occasional electronics
        project.
      </p>

      <div class="relative group">
        <!-- class="border-4 border-white shadow-xl rounded-2xl rotate-[-2deg] h-52 w-52 object-cover transition-all duration-300 ease-in-out group-hover:rotate-0 group-hover:scale-105 group-hover:shadow-2xl" -->
        <Image
          class="border-4 border-white shadow-xl rounded-2xl rotate-[-2deg] h-52 w-52 object-cover"
          src={michaelImg}
          alt="Portrait of Michael"
        />

        <!-- Santa Hat -->
        <div class="hat">
          <div class="hood"></div>
          <div class="curve"></div>
          <div class="bobble"></div>
          <div class="band"></div>
        </div>
      </div>
    </div>

    <h2 class="text-xl inline-block mb-6 border-b-[3px] border-b-[gold]">
      Latest Posts
    </h2>

    <FeaturedPosts />

    <h2 class="text-xl inline-block my-6 border-b-[3px] border-b-[gold]">
      Featured Projects
    </h2>

    <FeaturedProjects />

    <h2 class="text-xl inline-block my-6 border-b-[3px] border-b-[gold]">
      Contact me
    </h2>

    <Contact />
  </main>
</Base>

<style is:global>
  .timestamp-colon {
    display: inline-block;
    animation: blink 3s step-end infinite;
  }

  @keyframes blink {
    50% {
      opacity: 0;
    }
  }

  /* Santa Hat Styles */
  .hat {
    position: absolute;
    top: -10px;
    right: 80px;
    transform: rotate(12deg);
    z-index: 20;
  }

  .hood {
    width: 48px;
    height: 48px;
    background: linear-gradient(135deg, #e0002b 0%, #c00022 100%);
    border-radius: 100% 10% 0 10%;
    position: relative;
    z-index: 10;
    box-shadow:
      2px 3px 8px rgba(0, 0, 0, 0.15),
      inset -2px -2px 4px rgba(0, 0, 0, 0.1),
      inset 2px 2px 4px rgba(255, 255, 255, 0.2);
  }

  .band {
    position: absolute;
    bottom: -6px;
    left: -5px;
    width: 56px;
    height: 11px;
    background: radial-gradient(circle at 50% 50%, #ffffff 40%, #f5f5f5 100%);
    border-radius: 20px;
    box-shadow:
      0 2px 6px rgba(0, 0, 0, 0.2),
      inset 0 1px 2px rgba(255, 255, 255, 0.8);
    z-index: 20;
  }

  .curve {
    position: absolute;
    top: -4px;
    right: 0;
    width: 36px;
    height: 36px;
    background: linear-gradient(145deg, #c00022 0%, #a00020 100%);
    border-radius: 50%;
    transform: translate(40%, 10%) rotate(20deg);
    box-shadow:
      1px 2px 6px rgba(0, 0, 0, 0.2),
      inset -1px -1px 3px rgba(0, 0, 0, 0.15);
    z-index: 5;
  }

  .bobble {
    position: absolute;
    top: 20px;
    right: -20px;
    width: 20px;
    height: 20px;
    background: radial-gradient(circle at 35% 35%, #ffffff 0%, #e8e8e8 100%);
    border-radius: 50%;
    box-shadow:
      2px 3px 6px rgba(0, 0, 0, 0.25),
      inset -1px -1px 2px rgba(0, 0, 0, 0.1),
      inset 1px 1px 3px rgba(255, 255, 255, 0.9);
    z-index: 30;
  }
</style>

<script is:inline>
  function settime() {
    const timestamp = document.querySelector("[data-timestamp-text]");
    if (!timestamp || !("Intl" in window)) return;

    const prefix = timestamp
      .getAttribute("data-timestamp-text")
      .replace("{time}", "");
    timestamp.innerHTML = `${prefix}<span class="time-container"><span class="hours"></span><span class="timestamp-colon">:</span><span class="minutes"></span></span>`;

    const [hoursEl, minutesEl] = [
      timestamp.querySelector(".hours"),
      timestamp.querySelector(".minutes"),
    ];

    function updateTime() {
      const [hours, minutes] = new Intl.DateTimeFormat(
        navigator.language || "en-AU",
        {
          timeZone: "Australia/Brisbane",
          timeStyle: "short",
          hour12: false,
        }
      )
        .format(new Date())
        .split(":");

      hoursEl.textContent = hours;
      minutesEl.textContent = minutes;
    }

    updateTime();
    setInterval(updateTime, 60000);
  }

  settime();
</script>
