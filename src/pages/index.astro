---
import { Image } from "astro:assets";
import Base from "../layouts/Base.astro";
import FeaturedPosts from "../components/FeaturedPosts.astro";
import FeaturedProjects from "../components/FeaturedProjects.astro";
import Contact from "../components/Contact.astro";
import NewYearCelebration from "../components/NewYearCelebration.astro";
import greyMichael from "/public/me-grey.jpg";
---

<Base title="Michael Esteban">
  <!-- <NewYearCelebration /> -->
  <main>
    <h2 class="text-xl inline-block mb-2 border-b-[3px] border-b-[gold]">
      Hi!
    </h2>

    <div class="flex flex-col md:flex-row items-center gap-8 mb-6">
      <p class="text-lg md:w-2/3">
        I'm Michael Esteban, a software developer from sunny (and likely humid)
        Brisbane, Australia where it is{" "}
        <span data-timestamp-text="currently {time}">loading time...</span>. I
        create small, purpose-driven websites and interactive tools.
      </p>

      <Image
        class="border-4 border-white shadow-lg rounded-lg rotate-[-2deg] w-36 h-36 object-cover"
        src={greyMichael}
        alt="Portrait of Michael"
      />
    </div>

    <h2 class="text-xl inline-block mb-6 border-b-[3px] border-b-[gold]">
      Latest Posts
    </h2>

    <FeaturedPosts />

    <h2 class="text-xl inline-block my-6 border-b-[3px] border-b-[gold]">
      Featured Projects
    </h2>

    <FeaturedProjects />

    <h2 class="text-xl inline-block my-6 border-b-[3px] border-b-[gold]">
      Contact me
    </h2>

    <Contact />
  </main>
</Base>

<style is:global>
  .timestamp-colon {
    display: inline-block;
    animation: blink 3s step-end infinite;
  }

  @keyframes blink {
    50% {
      opacity: 0;
    }
  }
</style>

<script is:inline>
  function settime() {
    const timestamp = document.querySelector("[data-timestamp-text]");
    if (!timestamp || !("Intl" in window)) return;

    const prefix = timestamp
      .getAttribute("data-timestamp-text")
      .replace("{time}", "");
    timestamp.innerHTML = `${prefix}<span class="time-container"><span class="hours"></span><span class="timestamp-colon">:</span><span class="minutes"></span></span>`;

    const [hoursEl, minutesEl] = [
      timestamp.querySelector(".hours"),
      timestamp.querySelector(".minutes"),
    ];

    function updateTime() {
      const [hours, minutes] = new Intl.DateTimeFormat(
        navigator.language || "en-AU",
        {
          timeZone: "Australia/Brisbane",
          timeStyle: "short",
          hour12: false,
        }
      )
        .format(new Date())
        .split(":");

      hoursEl.textContent = hours;
      minutesEl.textContent = minutes;
    }

    updateTime();
    setInterval(updateTime, 60000);
  }

  settime();
</script>
